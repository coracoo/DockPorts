# æˆ‘çš„ä»“åº“

**1ï¸âƒ£** ï¼š ä¸­æ–‡dockeré¡¹ç›®é›†æˆé¡¹ç›®ï¼š [https://github.com/coracoo/awesome_docker_cn](https://github.com/coracoo/awesome_docker_cn)

**2ï¸âƒ£** ï¼š dockerè½¬composeï¼š[https://github.com/coracoo/docker2compose](https://github.com/coracoo/docker2compose)

**3ï¸âƒ£** ï¼š å®¹å™¨éƒ¨ç½²iSCSIï¼Œæ”¯æŒç»¿è”æç©ºé—´é£ç‰›ï¼š[https://github.com/coracoo/d-tgtadm/](https://github.com/coracoo/d-tgtadm/)

**4ï¸âƒ£** ï¼š å®¹å™¨ç«¯å£æ£€æŸ¥å·¥å…·ï¼š [https://github.com/coracoo/DockPorts/](https://github.com/coracoo/DockPorts)

# æˆ‘çš„é¢‘é“

### é¦–å‘å¹³å°â€”â€”ä»€ä¹ˆå€¼å¾—ä¹°ï¼š

### [â­ç‚¹æˆ‘å…³æ³¨](https://zhiyou.smzdm.com/member/9674309982/) 

### å¾®ä¿¡å…¬ä¼—å·ï¼š

![å…³æ³¨](https://github.com/user-attachments/assets/9a1c4de0-2f08-413f-ab7f-d7d463af1698)

---

# DockPorts - å®¹å™¨ç«¯å£ç›‘æ§å·¥å…·

ä¸€ä¸ªç°ä»£åŒ–çš„Dockerå®¹å™¨ç«¯å£ç›‘æ§å’Œå¯è§†åŒ–å·¥å…·ï¼Œå¸®åŠ©æ‚¨è½»æ¾ç®¡ç†å’Œç›‘æ§NASæˆ–æœåŠ¡å™¨ä¸Šçš„ç«¯å£ä½¿ç”¨æƒ…å†µã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ³ **Dockeré›†æˆ**: é€šè¿‡Docker APIå®æ—¶ç›‘æ§å®¹å™¨ç«¯å£æ˜ å°„
- ğŸ–¥ï¸ **ç³»ç»Ÿç›‘æ§**: ä½¿ç”¨netstatç›‘æ§ä¸»æœºç«¯å£ä½¿ç”¨æƒ…å†µ
- ğŸ“Š **å¯è§†åŒ–å±•ç¤º**: ç¾è§‚çš„å¡ç‰‡å¼ç•Œé¢ï¼Œç±»ä¼¼Docker Compose Makeré£æ ¼
- ğŸ”„ **å®æ—¶åˆ·æ–°**: æ”¯æŒæ‰‹åŠ¨å’Œè‡ªåŠ¨åˆ·æ–°ç«¯å£ä¿¡æ¯
- ğŸ“± **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- ğŸ¯ **æ™ºèƒ½æ’åº**: ç«¯å£æŒ‰é¡ºåºæ’åˆ—ï¼Œç©ºéš™ç”¨ç°è‰²å¡ç‰‡æ ‡æ³¨
- ğŸ·ï¸ **æ¥æºæ ‡è¯†**: åŒºåˆ†Dockerå®¹å™¨ç«¯å£å’Œç³»ç»ŸæœåŠ¡ç«¯å£
- ğŸ‘ï¸ **ç«¯å£éšè—**: æ”¯æŒéšè—ä¸éœ€è¦æ˜¾ç¤ºçš„ç«¯å£ï¼Œæä¾›"å·²éšè—"æ ‡ç­¾é¡µæŸ¥çœ‹
- ğŸ“‹ **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡éšè—/å–æ¶ˆéšè—ç«¯å£èŒƒå›´
- ğŸ¨ **è™šæ‹Ÿç«¯å£**: éšè—ç«¯å£ä»¥è™šçº¿è¾¹æ¡†æ ·å¼åŒºåˆ†æ˜¾ç¤º
- âš¡ **å®æ—¶åŒæ­¥**: éšè—/å–æ¶ˆéšè—æ“ä½œåç«‹å³æ›´æ–°æ˜¾ç¤ºçŠ¶æ€

## ğŸ–¼ï¸ ç•Œé¢é¢„è§ˆ

ç•Œé¢é‡‡ç”¨ç°ä»£åŒ–è®¾è®¡ï¼ŒåŒ…å«ï¼š
- è“è‰²æ¸å˜èƒŒæ™¯
- å¡ç‰‡å¼ç«¯å£å±•ç¤º
- å®æ—¶ç»Ÿè®¡ä¿¡æ¯
- å“åº”å¼å¸ƒå±€

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

1. å…‹éš†é¡¹ç›®ï¼š
```bash
git clone https://github.com/coracoo/DockPorts.git
cd DockPorts
```

2. å¯åŠ¨æœåŠ¡ï¼š
```bash
docker-compose up -d
```

3. è®¿é—®åº”ç”¨ï¼š
æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:7577`

### ä½¿ç”¨Dockerè¿è¡Œ

```bash
# ä½¿ç”¨é»˜è®¤ç«¯å£7577
docker run -d \
  --name dockports \
  --network host \
  -v /var/run/docker.sock:/var/run/docker.sock:ro \
  -v ./config:/app/config \
  ghcr.io/coracoo/dockports:latest

# ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£8080
docker run -d \
  --name dockports \
  --network host \
  -v /var/run/docker.sock:/var/run/docker.sock:ro \
  -v ./config:/app/config \
  -e DOCKPORTS_PORT=8080
  ghcr.io/coracoo/dockports:latest

# å¯ç”¨è°ƒè¯•æ¨¡å¼
docker run -d \
  --name dockports \
  --network host \
  -v /var/run/docker.sock:/var/run/docker.sock:ro \
  -v ./config:/app/config \
  ghcr.io/coracoo/dockports:latest --debug
```

### æœ¬åœ°å¼€å‘

1. å®‰è£…ä¾èµ–ï¼š
```bash
pip install -r requirements.txt
```

2. è¿è¡Œåº”ç”¨ï¼š
```bash
# ä½¿ç”¨é»˜è®¤ç«¯å£7577
python app.py

# ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£
python app.py --port 8080

# å¯ç”¨è°ƒè¯•æ¨¡å¼
python app.py --debug

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
python app.py --help
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Docker Engine 20.10+
- Docker Compose 2.0+
- Linuxç³»ç»Ÿï¼ˆæ”¯æŒnetstatå‘½ä»¤ï¼‰
- ç«¯å£7577å¯ç”¨

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `TZ` | `Asia/Shanghai` | æ—¶åŒºè®¾ç½® |
| `PYTHONUNBUFFERED` | `1` | Pythonè¾“å‡ºç¼“å†²è®¾ç½® |

## ğŸ”§ é…ç½®è¯´æ˜

### å‘½ä»¤è¡Œå‚æ•°

DockPorts æ”¯æŒä»¥ä¸‹å‘½ä»¤è¡Œå‚æ•°æ¥è‡ªå®šä¹‰è¿è¡Œé…ç½®ï¼š

| å‚æ•° | ç®€å†™ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--port` | `-p` | 7577 | WebæœåŠ¡ç«¯å£ |
| `--host` | - | 0.0.0.0 | WebæœåŠ¡ç›‘å¬åœ°å€ |
| `--debug` | - | false | å¯ç”¨è°ƒè¯•æ¨¡å¼ |
| `--help` | `-h` | - | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```bash
# ä¿®æ”¹ç«¯å£ä»¥é¿å…å†²çª
python app.py --port 8080

# åœ¨Dockerä¸­ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£
docker run -d --name dockports --network host \
  -v /var/run/docker.sock:/var/run/docker.sock:ro \
  -v ./config:/app/config \
  dockports --port 8080

# åœ¨docker-composeä¸­ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°
# å–æ¶ˆæ³¨é‡Š docker-compose.yml ä¸­çš„ command è¡Œå¹¶ä¿®æ”¹å‚æ•°
```

### å·æ˜ å°„

| ä¸»æœºè·¯å¾„ | å®¹å™¨è·¯å¾„ | è¯´æ˜ |
|----------|----------|------|
| `/var/run/docker.sock` | `/var/run/docker.sock` | Docker APIè®¿é—®ï¼ˆåªè¯»ï¼‰ |
| `./config` | `/app/config` | é…ç½®æ–‡ä»¶ç›®å½• |

## ğŸ“Š åŠŸèƒ½è¯¦è§£

### ç«¯å£ç›‘æ§

1. **Dockerå®¹å™¨ç«¯å£**ï¼š
   - è‡ªåŠ¨å‘ç°æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨
   - è·å–ç«¯å£æ˜ å°„ä¿¡æ¯
   - è¯†åˆ«hostç½‘ç»œæ¨¡å¼å®¹å™¨

2. **ç³»ç»Ÿç«¯å£**ï¼š
   - ä½¿ç”¨netstatæ‰«æç›‘å¬ç«¯å£
   - æ”¯æŒTCPå’ŒUDPåè®®
   - è¯†åˆ«ç³»ç»ŸæœåŠ¡å ç”¨çš„ç«¯å£

### å¯è§†åŒ–å±•ç¤º

1. **ç«¯å£å¡ç‰‡**ï¼š
   - å¤§å·ç«¯å£å·æ˜¾ç¤º
   - å®¹å™¨åç§°å’Œå†…éƒ¨ç«¯å£
   - æ¥æºæ ‡è¯†ï¼ˆDocker/ç³»ç»Ÿï¼‰
   - éšè—/å–æ¶ˆéšè—æŒ‰é’®

2. **é—´éš”å¡ç‰‡**ï¼š
   - æ˜¾ç¤ºè¿ç»­ç«¯å£é—´çš„ç©ºéš™
   - æ ‡æ³¨å¯ç”¨ç«¯å£æ•°é‡
   - ç°è‰²æ ·å¼åŒºåˆ†
   - æ”¯æŒæ‰¹é‡éšè—ç«¯å£èŒƒå›´

3. **è™šæ‹Ÿç«¯å£å¡ç‰‡**ï¼š
   - è™šçº¿è¾¹æ¡†æ ·å¼åŒºåˆ†
   - æ˜¾ç¤º"å·²éšè—ç«¯å£"æ ‡è¯†
   - æ”¯æŒå–æ¶ˆéšè—æ“ä½œ

4. **æ ‡ç­¾é¡µå¯¼èˆª**ï¼š
   - å…¨éƒ¨ç«¯å£
   - å·²ä½¿ç”¨ç«¯å£
   - å¯ç”¨ç«¯å£
   - å·²éšè—ç«¯å£

5. **ç»Ÿè®¡ä¿¡æ¯**ï¼š
   - å·²ä½¿ç”¨ç«¯å£æ€»æ•°
   - å¯ç”¨ç«¯å£æ€»æ•°
   - Dockerå®¹å™¨æ•°é‡

## ğŸ› ï¸ APIæ¥å£

### GET /api/ports
è·å–ç«¯å£ä¿¡æ¯

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "data": {
    "port_cards": [
      {
        "port": 80,
        "type": "used",
        "container_name": "nginx",
        "container_port": "80/tcp",
        "source": "docker"
      }
    ],
    "total_used": 10,
    "total_available": 65525,
    "docker_containers": 5
  }
}
```

### GET /api/refresh
åˆ·æ–°ç«¯å£ä¿¡æ¯

### éšè—ç«¯å£ç®¡ç†

#### GET /api/hidden-ports
è·å–éšè—ç«¯å£åˆ—è¡¨

#### POST /api/hidden-ports
éšè—å•ä¸ªç«¯å£
```json
{
  "port": 8080
}
```

#### DELETE /api/hidden-ports
å–æ¶ˆéšè—å•ä¸ªç«¯å£
```json
{
  "port": 8080
}
```

#### POST /api/hidden-ports/batch
æ‰¹é‡éšè—ç«¯å£
```json
{
  "ports": [8080, 8081, 8082]
}
```

#### DELETE /api/hidden-ports/batch
æ‰¹é‡å–æ¶ˆéšè—ç«¯å£
```json
{
  "ports": [8080, 8081, 8082]
}
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ— æ³•è¿æ¥Docker**ï¼š
   - ç¡®ä¿Docker socketå·²æ­£ç¡®æ˜ å°„
   - æ£€æŸ¥å®¹å™¨æ˜¯å¦æœ‰è®¿é—®Dockerçš„æƒé™

2. **netstatå‘½ä»¤ä¸å¯ç”¨**ï¼š
   - ç¡®ä¿å®¹å™¨å†…å®‰è£…äº†net-toolsåŒ…
   - æ£€æŸ¥/procç›®å½•æ˜¯å¦æ­£ç¡®æ˜ å°„

3. **ç«¯å£7577è¢«å ç”¨**ï¼š
   - ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
   - æˆ–åœæ­¢å ç”¨è¯¥ç«¯å£çš„æœåŠ¡

4. **éšè—ç«¯å£åŠŸèƒ½å¼‚å¸¸**ï¼š
   - æ£€æŸ¥config/hidden_ports.jsonæ–‡ä»¶æƒé™
   - ç¡®ä¿å®¹å™¨æœ‰å†™å…¥é…ç½®æ–‡ä»¶çš„æƒé™
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯

5. **å–æ¶ˆéšè—ç«¯å£èŒƒå›´å¤±è´¥**ï¼š
   - ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼ŒåŒ…å«æ‰¹é‡å–æ¶ˆéšè—API
   - æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIå“åº”

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker-compose logs -f dockports

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs -f dockports
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.1.0 (æœ€æ–°)
- âš™ï¸ æ–°å¢å‘½ä»¤è¡Œå‚æ•°æ”¯æŒï¼ˆ--port, --host, --debugï¼‰
- ğŸ”§ æ”¯æŒè‡ªå®šä¹‰WebæœåŠ¡ç«¯å£ï¼Œè§£å†³hostç½‘ç»œæ¨¡å¼ä¸‹ç«¯å£å†²çªé—®é¢˜
- ğŸ³ ä¼˜åŒ–Dockeré•œåƒæ„å»ºï¼Œæ”¯æŒENTRYPOINTä¼ å‚
- ğŸ“¦ æ›´æ–°GitHub Actionsé…ç½®ï¼Œç»Ÿä¸€é•œåƒåä¸ºDockPorts
- ğŸ‘ï¸ ç«¯å£éšè—åŠŸèƒ½ï¼Œæ”¯æŒéšè—ä¸éœ€è¦æ˜¾ç¤ºçš„ç«¯å£
- ğŸ³ åŸºç¡€Dockerå®¹å™¨ç«¯å£ç›‘æ§åŠŸèƒ½
- ğŸ–¥ï¸ ç³»ç»Ÿç«¯å£ç›‘æ§åŠŸèƒ½
- ğŸ“Š å¯è§†åŒ–ç«¯å£å±•ç¤ºç•Œé¢
- ğŸ”„ å®æ—¶åˆ·æ–°åŠŸèƒ½

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- ç•Œé¢è®¾è®¡çµæ„Ÿæ¥æºäº [Docker Compose Maker](https://github.com/ajnart/dcm)
- æ„Ÿè°¢Dockerå’ŒFlaskç¤¾åŒºçš„æ”¯æŒ

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤GitHub Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…

---

**DockPorts** - è®©ç«¯å£ç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆï¼ ğŸš€
